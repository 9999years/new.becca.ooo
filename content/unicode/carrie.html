<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="save characters in Tweets in dubiously useful ways">
<title>carrie</title>
<script src="/unicode/js/carrie.js"></script>
<style>
html, body, textarea {
	font-family: "Segoe UI", -apple-system, "Helvetica", "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji", "Noto Sans",  "FreeSans", "Code2001", "Code2000", "DejaVu Sans",  sans-serif;
	color: #fff;
	background-color: #113;
	font-size: 18px;
	margin: 0;
	padding: 0;
}

/* better underline with gradients */
a, a:visited {
	color: #99f;
	text-decoration: none;
	position: relative;
	background-image: linear-gradient(to bottom,rgba(0,0,0,0) 50%,rgba(153,153,255,0.8) 50%);
	background-repeat: repeat-x;
	background-size: 2px 0.1em;
	background-position: 0 1.3em;
}

a:hover {
	color: #f99;
	background-image: linear-gradient(to bottom,rgba(0,0,0,0) 50%,rgba(255,153,153,0.8) 50%);
}

.rule {
	width:100%;
	height:0;
	border-bottom:1px #99f dashed;
	margin:20px 0;
}

#container {
	margin:25px;
	max-width:600px;
}

.inline {
	display:inline;
}

.text_box {
	max-width:100%;
	width:600px;
	height:100px;
	display:block;
	border:1px #fff solid;
	margin:10px 0;
	padding:10px;
}
</style>
<div id="container">
	Plain:
	<textarea id="in" class="text_box">In Bruges looking for a theater thats. playing. rogue. one..gary. heard. i. Do. some. of. my best. work. in. it</textarea>
	Fisher style:
	<textarea id="out" class="text_box">In Bruges looking for a theater âœï¸ğŸ¨ğŸ…°âœï¸ğŸ’². ğŸ…¿ï¸ğŸ•’ğŸ…°âœŒğŸ¼â„¹â™‘ï¸g. Â®ğŸ…¾ï¸gâ›ğŸ“§. ğŸ…¾ï¸â™‘ï¸ğŸ“§..gğŸ…°Â®âœŒğŸ¼. ğŸ¨ğŸ“§ğŸ…°Â®d. â„¹. DğŸ…¾ï¸. ğŸ’²ğŸ…¾ï¸â“‚ï¸ğŸ“§. ğŸ…¾ï¸f. â“‚ï¸âœŒğŸ¼ ğŸ…±ï¸ğŸ“§ğŸ’²âœï¸. ã€°ğŸ…¾ï¸Â®k. â„¹â™‘ï¸. â„¹âœï¸</textarea>
	<div class="rule"> </div>
	Created by <a href="https://becca.ooo/">becca</a> with help from <a href="https://twitter.com/FakeUnicode">@FakeUnicode</a>
	<p><a href="https://en.m.wikipedia.org/wiki/Carrie_Fisher">Carrie Fisher</a>, best known for playing Princess Leia in Star Wars,
	<a href="https://twitter.com/carrieffisher">tweeted</a> long, nearly unreadable strings of emoji in lieu of regular text. Use this tool to tweet like her, decipher her tweets, or remember her.
</div>
<script>
function $(el) { return document.getElementById(el); }
// init variables
var textIn = $("in")
	,textOut = $("out")
	,textFiltered = ""
	,compressionRatio = 1
	,regexAstralSymbols = /[\uD800-\uDBFF][\uDC00-\uDFFF]/g;

textIn.value = textIn.innerHTML;
textOut.value = textOut.innerHTML;

function randomVal(arr) {
	return arr[Math.floor(Math.random() * arr.length)];
}

function encode(text) {
	for(var i = 0; i < replacements.length; i++) {
		text = text.replace(
			RegExp(replacements[i][0][0], "gi"),
			randomVal(replacements[i][1])
		);
	}
	return text;
}

function decode(text) {
	// strip fitzpatrick modifiers
	for(var i = 0x1f3fb; i <= 0x1f3ff; i++) {
		text = text.replace(
			RegExp(String.fromCodePoint(i), "gi"),
			""
		);
	}

	for(var i = 0; i < replacements.length; i++) {
		for(var j = 0; j < replacements[i][1].length; j++) {
			text = text.replace(
				RegExp(replacements[i][1][j], "gi"),
				replacements[i][0]
			);
		}
	}
	text = text.replace(/\ufe0f/g, "");
	return text.replace(/\s{2,}/g, " ");
}

function countSymbols(string) {
	// https://mathiasbynens.be/notes/javascript-unicode
	// (thanks mathias)
	return string
	// replace every surrogate pair with a bmp symbol to acct for 5 or 6
	// byte unicode symbols
	.replace(regexAstralSymbols, '.')
	// then get the length
	.length;
}

function selectAll() {
	// function to select text when the text boxes are clicked
	window.setTimeout(function() {
		// browsers are weird about this (it doesnt work w/o a delay)
		// can you believe there's a function containing 'exec' that
		// isn't a huge security hole?
		document.execCommand("selectAll", false, null);
	}, 1);
}

textIn.oninput = textIn.onchange = e => {
	textOut.value = encode(textIn.value.trim());
};

textOut.oninput = textOut.onchange = e => {
	textIn.value = decode(textOut.value.trim());
};

textIn.onfocus = e => {
	selectAll();
};

textOut.onfocus = e => {
	selectAll();
};
</script>
